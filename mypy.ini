[mypy]
# 启用 Pydantic 官方 mypy 插件
plugins = pydantic.mypy

# 可选：Pydantic 插件的额外配置（按需加）
[pydantic-mypy]
# 强制检查模型字段的类型注解
warn_required_dynamic_aliases = True
# 检查 computed_field 的返回类型是否匹配声明
warn_return_type = True
; [mypy]
# ==========================================
# 1. 指定检查的路径目录 (files)
# ==========================================
# 多个路径用逗号分隔，可以是目录或具体文件
files = src, tests/unit/

# ==========================================
# 2. 忽略路径 - 方案 A：全局正则排除 (exclude)
# ==========================================
# 适用于：完全不想让 mypy 读取的文件，如迁移文件、构建目录、临时文件
# 注意：这里使用的是正则表达式
exclude = (?x)(
    ^.venv/    # 忽略根目录下的 .venv 文件夹
    | ^.git/       # 忽略 .git 目录
    | ^log/       # 忽略 log 目录
    | ^wsm/       # 忽略 wsm 目录
    | ^docs/       # 忽略 wsm 目录
    | \.log$        # 忽略以 .log 结尾的文件
  )

# ==========================================
# 原有配置
# ==========================================
# 开启无类型注解函数的体检查
check_untyped_defs = True
# 可选：其他常用严格配置（建议开启，提升类型校验性）
disallow_untyped_defs = False  # 暂不强制所有函数加注解（后续可改True）
warn_return_any = True
warn_unused_configs = True

# ==========================================
# 3. 忽略路径 - 方案 B：针对特定模块/路径忽略 (另一种写法)
# ==========================================
# 适用于：虽然代码在源码中，但我想对这个旧模块“睁一只眼闭一只眼”，
# 或者这个模块引入了无法解析的第三方库。

; # 例子：忽略 legacy_code 目录下的所有报错
; [mypy-legacy_code.*]
; ignore_errors = True

; # 例子：忽略 third_party 目录下所有文件的导入错误
; [mypy-third_party.*]
; ignore_missing_imports = True